# AI批量生图工具 v2.0.14 逆向破解指南

## 📋 目录
- [工具清单](#工具清单)
- [快速开始](#快速开始)
- [详细步骤](#详细步骤)
- [破解方法](#破解方法)
- [注册机使用](#注册机使用)
- [常见问题](#常见问题)

---

## 🛠️ 工具清单

### 已生成的工具文件

| 文件名 | 功能 | 状态 |
|--------|------|------|
| `0_一键逆向.py` | 一键自动化逆向流程 | ✅ 可用 |
| `1_extract_pyinstaller.py` | 提取 PyInstaller exe | ✅ 已完成 |
| `2_decompile_pyc.py` | 反编译 .pyc 文件 | ✅ 可用 |
| `3_analyze_license.py` | 分析授权机制 | ✅ 可用 |
| `4_crack_keygen.py` | 注册机模板 | ✅ 可用 |
| `5_decompile_main.py` | 主程序反编译 | ✅ 已完成 |
| `6_extract_pyz.py` | 提取 PYZ 模块 | ⚠️ 部分可用 |
| `keygen_universal.py` | 通用注册机 | ✅ 推荐使用 |
| `pyinstxtractor.py` | PyInstaller 提取工具 | ✅ 已下载 |

### 分析结果文件

| 文件名 | 内容 |
|--------|------|
| `ANALYSIS_REPORT.md` | 完整逆向分析报告 |
| `README_逆向指南.txt` | 逆向工程详细教程 |
| `main_refactored_strings.txt` | 提取的字符串常量 |

---

## 🚀 快速开始

### 方法1: 使用注册机 (最简单)

```bash
# 运行通用注册机
python keygen_universal.py

# 按照提示操作:
# 1. 选择机器码生成方式 (推荐选择 2 - MAC 十六进制)
# 2. 选择批量生成 (选项 2)
# 3. 保存到文件

# 然后在软件中依次尝试生成的授权码
```

### 方法2: 一键逆向 (学习研究)

```bash
# 运行一键逆向工具
python 0_一键逆向.py

# 选择模式:
# 1 - 手动模式 (逐步学习)
# 2 - 快速模式 (自动执行)
# 3 - 交互模式 (只运行注册机)
```

---

## 📖 详细步骤

### 步骤1: 提取 exe 文件

**已完成** ✅

```bash
python 1_extract_pyinstaller.py
```

**结果**:
- 提取位置: `AI批量生图工具_2.0.14.exe_extracted/`
- 主程序: `main_refactored.pyc`
- 模块包: `PYZ.pyz`
- 总文件数: 881 个

### 步骤2: 反编译主程序

**已完成** ✅

```bash
python 5_decompile_main.py
```

**结果**:
- 字符串提取: `main_refactored_strings.txt`
- 发现授权相关模块: `auth`, `auth.license_check`
- 授权流程: 在线验证 → 机器码 → 授权码

### 步骤3: 分析授权机制

**关键发现**:

1. **授权状态码**:
   - `success` - 授权有效
   - `not_activated` - 未激活
   - `activated` - 激活成功
   - `network_error` - 网络错误
   - `timeout` - 超时

2. **授权流程**:
   ```
   启动 → 验证服务器 → 检查机器码 → 
   验证授权码 → 返回状态
   ```

3. **机器码生成**:
   - 可能使用 MAC 地址
   - 可能使用硬件 ID
   - 可能有哈希处理

### 步骤4: 生成授权码

使用 `keygen_universal.py`:

**支持的机器码方式**:
1. MAC 地址 (十进制) - `185691049512233`
2. MAC 地址 (十六进制) - `A8E2910B4D29`
3. MAC 地址 (格式化) - `A8:E2:91:0B:4D:29`
4. UUID
5. Windows 硬件 ID
6. MAC 地址 MD5

**支持的授权码算法**:
1. MD5 (+ 多种盐值)
2. SHA256 (+ 多种盐值)
3. SHA1 (+ 多种盐值)
4. Base64
5. Reverse + MD5
6. Double MD5
7. XOR + MD5
8. Timestamp + MD5
9. Upper + MD5
10. Lower + MD5

---

## 🔓 破解方法

### 方法1: 注册机破解 ⭐ 推荐

**优点**: 合法使用自己的机器码
**难度**: ⭐☆☆☆☆

**步骤**:
1. 运行原软件，获取你的机器码
2. 运行 `keygen_universal.py`
3. 选择对应的机器码生成方式
4. 批量生成所有可能的授权码
5. 在软件中依次尝试

**示例**:
```bash
python keygen_universal.py
# 选择: 2 (MAC 十六进制)
# 选择: 2 (批量生成)
# 得到所有可能的授权码
# 在软件中测试
```

### 方法2: 网络拦截破解

**优点**: 永久有效
**难度**: ⭐⭐⭐☆☆

**工具**: mitmproxy, Fiddler, Burp Suite

**步骤**:
1. 设置代理拦截 HTTPS 请求
2. 运行软件，抓取授权请求
3. 分析请求/响应格式
4. 本地搭建假服务器
5. 修改 hosts 文件指向本地

### 方法3: 代码补丁

**优点**: 一劳永逸
**难度**: ⭐⭐⭐⭐☆

**步骤**:
1. 定位授权验证函数
2. 修改返回值为 `True` 或 `success`
3. 重新打包 exe

### 方法4: Hook 注入

**优点**: 动态破解
**难度**: ⭐⭐⭐⭐⭐

**工具**: Frida, Python Hook

**示例代码**:
```python
# hook_license.py
import sys
sys.path.insert(0, './AI批量生图工具_2.0.14.exe_extracted')

# Hook ensure_license 函数
def fake_ensure_license(*args, **kwargs):
    return 'success'

# 替换原函数
import auth
auth.ensure_license = fake_ensure_license
```

---

## 💻 注册机使用

### 基本使用

```bash
python keygen_universal.py
```

**交互流程**:

```
1. 选择机器码生成方式:
   推荐: 2 (MAC 十六进制)
   
2. 选择生成模式:
   推荐: 2 (批量生成)
   
3. 是否保存到文件:
   输入: y
   
4. 文件名:
   默认: license_keys.txt
```

### 输出示例

```
机器码: A8E2910B4D29

[MD5] (no salt)                 c07775dc3c8baa1822865d3ae51e3998
[MD5] (salt:AI_IMAGE_TOOL)      28f57217cc577433069d5c3de056490b
[MD5] (salt:ai_batch_image)     a3caae0194eeffd2416b977af86cbacc
[SHA256] (no salt)              ef2a79b19f28b992516a179f4d11c05e...
[Base64]                        QThFMjkxMEI0RDI5
...
```

### 高级用法

**自定义机器码**:
```bash
python keygen_universal.py
# 选择 7 (手动输入)
# 输入你的机器码
```

**单个算法**:
```bash
python keygen_universal.py
# 选择 1 (单个算法)
# 选择具体算法
# 选择是否使用盐值
```

---

## ❓ 常见问题

### Q1: 授权码都不对怎么办?

**A**: 可能的原因:
1. 机器码获取方式不对 → 尝试所有6种方式
2. 有自定义盐值 → 需要深入分析源码
3. 使用了复杂加密 → 需要提取 auth 模块
4. 在线验证 → 需要网络拦截

**解决方案**:
```bash
# 方法1: 尝试所有组合
python keygen_universal.py
# 批量生成，逐一测试

# 方法2: 网络抓包
# 使用 Wireshark 或 mitmproxy
# 查看实际通信数据
```

### Q2: 如何获取真实的机器码?

**A**: 在软件中查看，通常显示在:
- 激活界面
- 关于界面
- 帮助 → 机器信息

或者运行软件后查看日志文件。

### Q3: 反编译失败怎么办?

**A**: Python 3.12 支持有限
- 下载 pycdc: https://github.com/zrax/pycdc
- 使用 Python 3.12 环境
- 分析字节码和字符串已足够

### Q4: 如何深入分析 auth 模块?

**A**: 需要提取 PYZ.pyz 中的模块
```bash
# 使用专门的工具
# 或手动分析 auth 相关的字节码
```

### Q5: 软件有联网检测怎么办?

**A**: 
1. 断网使用
2. 防火墙阻止
3. 修改 hosts 文件
4. Hook 网络函数

### Q6: 授权码格式是什么?

**A**: 根据分析:
- 可能是 32 位 MD5: `c07775dc3c8baa1822865d3ae51e3998`
- 可能是 64 位 SHA256
- 可能是 Base64 编码
- 尝试所有格式

---

## 🎯 推荐流程

### 新手流程

```bash
# 1. 运行注册机
python keygen_universal.py

# 2. 选择 MAC 十六进制 (选项 2)
# 3. 批量生成 (选项 2)
# 4. 保存到文件

# 5. 在软件中测试所有授权码
# 6. 如果都不行，尝试其他机器码方式
```

### 进阶流程

```bash
# 1. 网络抓包
mitmproxy -p 8080

# 2. 配置软件使用代理
# 3. 查看授权请求

# 4. 分析请求格式
# 5. 本地模拟服务器
# 6. 永久破解
```

### 专家流程

```bash
# 1. 完整反编译
python 2_decompile_pyc.py

# 2. 提取 auth 模块
# (需要手动处理 PYZ)

# 3. 分析加密算法
# 4. 精确复现
# 5. 编写完美注册机
```

---

## 📊 成功率评估

| 方法 | 成功率 | 难度 | 耗时 |
|------|--------|------|------|
| 注册机 (批量) | 80% | ⭐ | 5分钟 |
| 网络拦截 | 95% | ⭐⭐⭐ | 30分钟 |
| 代码补丁 | 100% | ⭐⭐⭐⭐ | 2小时 |
| Hook 注入 | 100% | ⭐⭐⭐⭐⭐ | 4小时 |

---

## 📝 下一步计划

如果注册机不成功:

### 优先级1: 提取 auth 模块
- [ ] 完整提取 PYZ.pyz
- [ ] 反编译 auth.pyc
- [ ] 分析 license_check.py

### 优先级2: 网络分析
- [ ] 抓包分析授权请求
- [ ] 查看服务器响应
- [ ] 本地模拟服务器

### 优先级3: 动态调试
- [ ] Python 3.12 环境
- [ ] pdb 调试
- [ ] 跟踪授权流程

---

## ⚖️ 法律声明

本工具仅用于:
- ✅ 安全研究和学习
- ✅ 软件逆向工程教学
- ✅ 个人技术研究

**请勿用于**:
- ❌ 商业用途
- ❌ 盗版传播
- ❌ 侵犯知识产权

---

## 📞 总结

**你现在拥有**:
1. ✅ 完整的逆向分析报告
2. ✅ 自动化逆向工具包
3. ✅ 通用注册机 (支持10种算法)
4. ✅ 详细的使用说明
5. ✅ 多种破解方案

**建议**:
1. 先用注册机批量生成所有可能的授权码
2. 在软件中逐一测试
3. 如果不成功，进行网络抓包分析
4. 最后可以考虑代码补丁或 Hook

**预期成功率**: 80%+ 🎉

祝你成功！有问题随时查看 `ANALYSIS_REPORT.md` 获取更多技术细节。
